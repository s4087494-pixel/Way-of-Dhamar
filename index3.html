<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Way of Dhamar</title>
      <link rel="stylesheet" href="https://use.typekit.net/apq2zsr.css">
    <link rel="stylesheet" href="style3.css">
</head>

<body>
    <div id="nirvanaLayer" class="sceneLayer isOn">
        <div id="nirvana"></div>
        <div id="p5Overlay"></div>
    </div>
    <div id="asuraLayer" class="sceneLayer">
        <div id="asura"></div>
    </div>
    <div id="loadingStatus"
        style="position: absolute; top: 10px; left: 10px; color: white; z-index: 100; background: rgba(0,0,0,0.7); padding: 10px; border-radius: 5px; font-family: monospace;">
        <div>Hand 1: <span id="hand1Status">-</span></div>
        <div>Hand 2: <span id="hand2Status">-</span></div>
        <div>Scene: <span id="sceneStatus">Loading...</span></div>
    </div>
    <canvas id="canvasOutput"
        style="position: absolute; top: 10px; right: 10px; width: 200px; border: 2px solid white; z-index: 100;">
    </canvas>
    <video id="handVideo" style="display: none;" autoplay playsinline muted>
    </video>
    <!-- Load p5 first -->
    <script src="https://cdn.jsdelivr.net/npm/p5@1.9.4/lib/p5.min.js"></script>
    <!-- Then MediaPipe -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
    <!-- Then other scripts -->
    <script src="handTracking.js"></script>
    <script src="script4.js"></script>
    <script src="script5.js"></script>
    <script src="overlayWords.js"></script>
    <script src="overlayWords2.js"></script>
    <div class="title"><h1>Move right hand to reveal the words</h1></div>
    <div class="fog"></div>
    <div class="white"></div>
    <div class="noise"></div>
    <div class="button" id="delayedButton" style="display: none;">
        <a class="btn-stream" href="index4.html" aria-label="Enter the stream">
            <video autoplay loop muted playsinline preload="auto" poster="assets/pictures/texture2.png">
                <source src="assets/animation/button_stream2.mov" type="video/quicktime">
                <!-- If you add an mp4 later, place it here for broader support -->
            </video>
        </a>
     </div>
     <script>
        // Pick the first playable source for the button video
        (function ensureButtonVideoPlays() {
            const video = document.querySelector('.btn-stream video');
            if (!video) return;

            const sources = [
                // Try MOV first (some browsers handle this better than webm with alpha)
                { src: 'assets/animation/button_stream2.mov', type: 'video/quicktime' },
                { src: 'assets/animation/button_stream2.webm', type: 'video/webm' }
            ];

            const playable = sources.find(s => video.canPlayType && video.canPlayType(s.type).replace(/no/, ''));
            const chosen = playable || sources[0];
            video.src = chosen.src;
            video.load();
            video.play().catch(() => {
                // Autoplay might be blocked; poster still shows
            });

            video.addEventListener('error', () => {
                console.warn('Button video failed to load; showing poster only.', video.error);
            });
        })();

        // Show button after 30 seconds
        setTimeout(() => {
            const btn = document.getElementById('delayedButton');
            if (btn) btn.style.display = 'block';
        }, 30000);
     </script>
</body>